---
title: 丢番图逼近之一 -- 为什么355/113能很好地代替圆周率pi?
mathjax: true
date: 2024-10-22 12:00:52
categories:
    - 丢番图逼近
tags:
    - number theory
    - Diophantine approximation
    - continued fractions
---

#### 引言

本文实际上是我在我们自己的学辅网站上写的帖子,稍加修改直接搬过来,免得到现在都没有一篇正式的帖子.

***如果知道以下知识可能更容易理解: 但是本文不需要前置知识!!!***

#### 问题解答

回到我们的问题,其实在群里的人应该已经知道了,这个问题其实就是:

>为什么在分母小于$16000$的所有分数里,$\frac{355}{113}$是最接近圆周率$\pi$的?

本文将在解决上述问题之后,再介绍连分数这个工具,以及连分数和该问题的联系.由于本科(包括数学系)并不会专门学习连分数,因此本文也只会简单地介绍一些比较有趣的结论,感兴趣的同学可以到参考文献部分去更系统地了解.文中也会有一些小问题留给大家思考,也欢迎大家进行尝试.

我们现在知道了圆周率的值为$\pi=3.1415926\cdots$,因此理论上我们都可以找到一个分数让它足够接近$\pi$,比如我们就可以取$\frac{p}{q}=\frac{31415926}{10000000}=\frac{15707963}{5000000}$,而它与$\pi$的误差也控制在了$1.0\times10^{-7}$内.但是很显然,这个数的分母太大了,稍不留神就少写或者多写了个$0$.而$\frac{355}{113}=3.141592920\cdots$与$\pi$的误差仅有$2.668\times10^{-7}$,精确程度和前者差不了多少,但是分母却小了太多太多,而且$113355$也十分便于记忆,并且它还有自己的名字--"密率",$\frac{355}{113}$它已经赢了太多了.

我们现在来考虑一下,如果一个分数要比$\frac{355}{113}$更精确,那分母应该至少有多大呢?

$\quad$ 首先我们已经知道有:

$$0<|\frac{355}{113}-\pi|<2.668\times10^{-7}$$

$\quad$ 如果$\frac{p}{q}$比$\frac{355}{113}$更接近$\pi$,其中假设$p,q$为互素的正数,那么应该也有:

$$0<|\frac{p}{q}-\pi|<2.668\times10^{-7}$$

$\quad$ 从而由绝对值不等式:

$$0<|\frac{355}{113}-\frac{p}{q}|=|\frac{355q-113p}{113q}|<2\times2.668\times10^{-7}$$

$\quad$ 由于$p$和$q$都是正整数,故$|355q-113p|$为正整数,必然是有$1\le |355q-113p|$的.故而有:

$$\frac{1}{113q}<2\times2.668\times10^{-7}$$

$$q>\frac{1}{113\times2\times2.668\times10^{-7}}>16584$$

也就是说,如果我想找一个比$\frac{355}{113}$更接近$\pi$的分数,那么它的分母(也就是$q$)必须是大于$16584$的!事实也是这样子的,我们可以找到$\frac{52163}{16604}=3.141592387\cdots$,它只接近了一点点,但是分母却是大了不止一点点.[1]

###### 思考题来喽!

$\quad$现在试着证明一下,在分母小于50的所有分数里,$\frac{22}{7}$是最接近圆周率$\pi$的,而这个分数也称为"约率".

#### 超强工具-连分数

##### 连分数的定义与符号

那么我们怎么得到$\frac{22}{7}$和$\frac{355}{113}$呢?难道就是用计算机算的吗?但是这两个分数不是祖冲之就发现了的吗?

实际上,我们也不知道祖冲之到底是如何得到的.但是我们的确有方法能够得到$\pi$的分数逼近形式,并且能够推广到任何无理数,而我们需要用到的工具就是连分数.

我们写出$\pi$的连分数形式:

$$\begin{equation}
  x = 3 + \cfrac{1}{7 
          + \cfrac{1}{15 
          + \cfrac{1}{1 
          + \cfrac{1}{292
          + \cfrac{1}{\cdots} } } } }
\end{equation}$$

因此我们可以这么按照上面的格式来定义连分数,并且为了简单起见,我们用一个新的符号来表示:

> **定义1:** $[a_0;a_1,a_2,a_3,\cdots]=
\begin{equation}
    a_0 + \cfrac{1}{a_1 
          + \cfrac{1}{a_2 
          + \cfrac{1}{a_3 + \cfrac{1}{\cdots} } } }
\end{equation}$,其中$a_0$可以为任意整数,而$a_1,a_2,\cdots$则要求为大于等于$1$的正整数.

当然有限项也是可行的,并且由朴素的数学逻辑思维可知,当里面为有限项时,其对应的值为一个分数,也就是有理数.以下我们给出几个例子(有限项的例子大家可以自己试一试,对这个符号更熟悉一些):

$\quad$ 1. $\pi = [3;7,15,1,292,\cdots]$ (无理数对应了一个无限连分数)

$\quad$ 2. $[2;2,2,2,\cdots] = \sqrt{2}+1$ (无限连分数对应一个无理数)

$\quad$ 3. $[3;7] = \frac{22}{7}$ (有限连分数对应了一个有理数)

$\quad$ 4. $[3;7,15] = \frac{333}{106}$

$\quad$ 5. $[3;7,14,1] = \frac{333}{106}$

$\quad$ 6. $[3;7,15,1] = \frac{355}{113}$

$\quad$ 7. $[3;7,15,1,292] = \frac{103993}{33102}$

$\quad$ 8. $\frac{206}{7} = [29;2,2,1]$ (有理数对应有限连分数形式)

###### 思考题又来喽!

$\quad$ 试着把$\frac{18}{7}$写成连分数的形式(数学专业同学可以和带余除法比较一下,看有没有熟悉的感觉).

##### 连分数与实数的关系

由上面的这些例子我们就得到了约率和密率,并且我们还能隐约找到一些规律,在这里我就直接给出其中的一些定理,感兴趣的可以去看看这个[网站](https://chaoli.club/index.php/2756?see_lz=1)上的内容.[2]

> **定理1:** 有理数和有限连分数是"一一对应"的(需要规定上述4和5中的连分数是同一个).

> **定理2:** 无理数和无限连分数是一一对应的.

> **定理3(Lagrange定理):** 循环无限连分数和二次无理数(即只有二次根号)是一一对应的(例如上述的2).

有一些无理数的连分数展开形式是比较容易的,例如$\sqrt{2}+1$,$\frac{\sqrt{5}+1}{2}$(后者即为黄金比例,前者俗称白银比例,更多可见[此处](https://www.bilibili.com/video/BV1Kb411H7mD/?spm_id_from=333.1007.0.0))[3],此处我们来展一下$\sqrt{2}+1$:

$\quad$ 注意到$\alpha=\sqrt{2}+1$是方程$x^2-2x-1=0$的解,于是有(熟悉一下我们刚刚的定义哦)

$$\alpha=2+\frac{1}{\alpha}=[2;\alpha]$$

$\quad$ 将右侧的$\alpha$用一次上述的等式,即得到

$$\alpha=
\begin{equation}
    2 + \cfrac{1}{2 
      + \cfrac{1}{\alpha}}
\end{equation}=[2;2,\alpha]$$

$\quad$ 再重复将上面的$\alpha$换成等式右侧后,我们最后得到了例子2里的格式,即

$$\sqrt{2}+1=\alpha=[2;2,2,2,\cdots]$$

###### 思考题!启动!

$\quad$ 模仿$\sqrt{2}+1$的连分数展开方式,试着将$\frac{\sqrt{5}+1}{2}$展开为连分数形式.

##### 无限连分数蕴含的一些大小关系

然后我们再来看看无限连分数和它的有限部分连分数的大小关系,我们这里也以$\pi = [3;7,15,1,292,\cdots]$为例,其有限部分连分数依次为$[3],[3;7],[3;7,15],[3;7,15,1],[3;7,15,1,292],\cdots$.我们能够得到以下的大小排列关系:

$$[3]<[3;7,15]<[3;7,15,1,292]<\cdots<\pi<\cdots<[3;7,15,1]<[3;7]$$

写成分数形式即:

$$3<\frac{333}{106}<\frac{103993}{33102}<\cdots<\pi<\cdots<\frac{355}{113}<\frac{22}{7}$$

> **定义2:** 若记$[a_0;a_1,a_2,a_3,\cdots]$的有限连分数$[a_0;a_1,a_2,\cdots,a_n]$化为分数形式$\frac{p_n}{q_n}$,并且称之为第$n$项逼近分数.

于是$[a_0]=\frac{a_0}{1}$,即$p_0=a_0,q_0=1$,$[a_0;a_1]=\frac{a_0a_1+1}{a_1}$,即$p_1=a_0a_1+1,q_1=a_1$.*注意:[3;7,15]是偶数项逼近分数,虽然它括号里有3个数.*于是我们又有以下定理(证明仍可以见[网站](https://chaoli.club/index.php/2756?see_lz=1)),建议结合上面$\pi$的例子来理解:

> **定理4:** $p_{n+1}=a_{n+1}p_n+p_{n-1},q_{n+1}=a_{n+1}q_n+q_{n-1}$ (递推公式,想了又想还是贴上来了,毕竟是连分数里的基本定理)

> **定理5:** $\dfrac{p_{n+1}}{q_{n+1}}-\dfrac{p_n}{q_n}=\dfrac{(-1)^n}{q_{n+1}q_n}$ (即通分之后,分子只可能为$\pm 1$)

> **定理6:** $\dfrac{p_{n+2}}{q_{n+2}}-\dfrac{p_n}{q_n}=\dfrac{(-1)^na_{n+2}}{q_{n+2}q_n}$ (其实也就是上面的推论)

> **定理7:** $\dfrac{p_0}{q_0}<\dfrac{p_2}{q_2}<\cdots$,以及$\cdots<\dfrac{p_3}{q_3}<\dfrac{p_1}{q_1}$ (即偶数项逼近分数是严格递增的,而奇数项逼近分数是严格递减的)

###### 已经是最后一批思考题了.

$\quad$ 1. 写出$\pi=[3;7,15,1,292,\cdots]$中$p_i,q_i(0\le i\le 4)$分别为多少($p_i,q_i$的定义见定义2)?

$\quad$ 2. 利用定理5和定理7,试着证明数列${[a_0;a_1,a_2,\cdots,a_n]}$的极限是存在的(这就是我给这篇文章打上极限tag的底气!!!).

$\quad$ 3. (数学系同学可以试试)只用定理4来证明定理5,定理6和定理7(能叫做『基本定理』的含金量!!!).

$\quad$ 4. (数学系同学可以试试)证明对任意$n\ge 1$,都有$(p_n,p_{n+1})=1,(q_n,q_{n+1})=1$(根据定理5可以证明).

##### 最优逼近以及辛钦常数

最后我们来解释一下,为什么在$\pi$的连分数展开式中,竟然就包括了"约率"和"密率"这两个神奇的值.现在我们再引入两个概念,帮助我们更方便地理解原因(~~数学是这样的,只要引入概念就好了,学生需要考虑的事就多了~~):

> **定义3:** $\frac{p}{q}$被称为$x$的第一类最优逼近,如果对于任意$a$为整数,$0<b\le q$,且$\frac{a}{b}\neq\frac{p}{q}$,有$|x-\frac{a}{b}|>|x-\frac{p}{q}|$.

> **定义4:** $\frac{p}{q}$被称为$x$的第二类最优逼近,如果对于任意$a$为整数,$0<b\le q$,且$\frac{a}{b}\neq\frac{p}{q}$,有$|bx-a|>|qx-p|$,即$|x-\frac{a}{b}|>\frac{q}{b}|x-\frac{p}{q}|$.

大白话就是:在分母不大于$q$的所有分数里,$\frac{p}{q}$是最接近$x$的,那它就是$x$的第一类最优逼近,而第二类最优逼近比第一类最优逼近更强.

比如$\frac{52163}{16604}$就是$\pi$的第一类最优逼近,但不是第二类最优逼近(此处不证明了).而我们又有一下事实:

> **定理8:** 若$x$是无理数,其连分数展开为$[a_0;a_1,a_2,\cdots]$,则每一个有限部分连分数$[a_0;a_1,\cdots,a_n]$都是$x$的第二类最优逼近,从而也是第一类最优逼近.

因此我们可以通过取无限连分数的有限部分连分数,从而用比较简单的有理数去最有效地逼近这个无理数.从而我们可以用$\frac{355}{113}$去很好地逼近$\pi$,而它在分母小于$16000$都是最优的原因之一则是它的连分数展开式的下一项是$292$,从而有这种很神奇的结果.

既然都看到这里了,那我不妨再加一点点(~~让我再讲五分钟!~~).定理3告诉我们,二次无理数的连分数展开式一定是循环的,而$\pi$的连分数展开式则无规则许多,难道我们对它真的没有更深入的了解方法了吗?其实不是的,下面的事实反而更加揭示了$\pi$这个数的神奇:

> **定理9(辛钦定理):** 对几乎所有实数$x$(除有理数,实系数二次方程的解,以及自然常数$\textrm{e}$等情况外),记$x$的连分数展开式为$[a_0;a_1,a_2,\cdots]$,则$\lim_{n\to \infty}(\prod_{i=1}^n a_i)^{1/n}$趋近于一个常数$K_0=2.685452\cdots$,现在称之为辛钦常数.[4]

定理中的"几乎所有",其实也是一个数学语言,常常出现在实变函数中.而$\pi$是满足辛钦定理的!也就是说,虽然$\pi$的连分数展开式是无规则的,但是我们取$3,15,7,1,292,\cdots$的几何平均值却是趋近于一个与$\pi$并无关系的常数.因此辛钦常数的存在肯定也是有很深刻的原因的,只可惜我们对它了解甚少.即使是最著名的无理数之一的$\pi$,其身上也还有诸多谜题.

感谢你能够看到这里!越写越起劲,感觉成我自己个人的抄书报告了(虽然也确实是这么一回事).

#### 参考资料

[1] 张景中.数学家的眼光.P8-P15

$\quad$ *这本书我觉得是挺值得一看的科普书,其中张景中是中国科学院院士,专业知识还是过硬的,肯定不是民科hhh.书中还有其它一些有意思的问题和想法,比如:*

$\quad$ *$x^3+ax^2+bx+c=0$,其中$a,b,c$都是绝对值不大于$10$的整数,先将有限小数$\alpha=0.414214$代入得$|\alpha^3+a\alpha^2+b\alpha+c|<2\times10^{-6}$,那我们就可以确定$\sqrt{2}-1=0.41421356\cdots$一定是该方程的解.(见P56)*

$\quad$ *这其实并不是很显然的结果,大家可以理解为"我只画了一个三角形,量出来内角和为$180^\circ$,于是可以下结论:所有三角形的内角和为$180^\circ$".而这些内容在机器证明数学定理中是最基本的方法.*

$\quad$ *以及本书后半部分还介绍了如何用不等式去理解极限(P192),也可以去看看,多一种想法.*

[2] FatFish.连分数入门-超理论坛.https://chaoli.club/index.php/2756?see_lz=1

$\quad$ *这位楼主讲的连分数入门可以说是很全面了,本文很多内容也是参考他的思路和想法,并且他还讲了一些更深的涉及到丢番图逼近(数论的一个子方向)的内容.*

$\quad$ *虽说是"入门",但后面的内容不是数学系的话恐怕也会很容易觉得枯燥(这就是数学!),但是前面7楼还是比较容易理解的了,本文也只到这一块.*

[3] 妈咪说MommyTalk.三维空间的黄金比例是多少？关于黄金分割的各种脑洞.https://www.bilibili.com/video/BV1Kb411H7mD/?spm_id_from=333.1007.0.0

$\quad$ *介绍了黄金比例,白银比例等比较有趣的概念,并且也涉及到了这些比例值的无限循环连分数展开.或者说,就是因为是最简单的一类循环连分数,所以才有专门的名字.*

[4] 辛钦.连分数.第三章第16节

$\quad$ *辛钦的这本小册子也是深入浅出,只有100多页,但是是连分数最知名的著作之一,这本也是上述FatFish的主要参考读本之一.最后一节涉及到的就是我最后提到的辛钦定理*

[5] Schimidt.Diophinatine Approximation

$\quad$ 4*这本则是我学习丢番图逼近所使用的教材,也是学习这本书的过程中才发现最开始提出的问题还蕴含了更深的数学思想,这也是本文能顺产的动机之一了.(~~虽然我也没学多少就是了~~)*